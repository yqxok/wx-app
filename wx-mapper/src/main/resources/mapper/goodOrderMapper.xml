<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pri.yqx.mapper.GoodOrderMapper">


    <select id="getSimpleOrderVos" parameterType="pri.yqx.dto.SimpleOrderDto" resultType="pri.yqx.vo.SimpleOrderVo">
        select o.order_id,o.number,o.total_price,o.status,o.good_id,o.html,o.pic_url,u.user_id,u.user_name,u.profile_pic_url
        from (select * from wx_good_order o where <if test="isDeliverer==true"> o.deliverer_id=#{userId}
        and o.deliverer_deleted=false </if><if test="isDeliverer==false">o.receiver_id=#{userId}
        and o.receiver_deleted=false </if> <if test="status!=null">and o.status=#{status} </if> ) o inner join wx_user u on <if test="isDeliverer==true">o.receiver_id=</if>
        <if test="isDeliverer==false">o.deliverer_id=</if> u.user_id order by o.create_time desc limit #{page},#{pageSize};
    </select>
    <select id="getGoodByOrderId" resultType="pri.yqx.entity.Good">
        select g.good_id,g.status,g.good_num from wx_good_order o inner join wx_good g on o.good_id=g.good_id where o.order_id=#{orderId};
    </select>
<!--inner join wx_user u on <if test="isDeliverer==true">o.receiver_id=</if>
        <if test="isDeliverer==false">o.deliverer_id=</if> u.user_id where <if test="isDeliverer==true">o.deliverer_id=</if>
        <if test="isDeliverer==false">o.receiver_id=</if> #{userId}<if test="status!=null">and o.status=#{status} </if>
        order by o.create_time desc limit #{page},#{pageSize};-->
</mapper>
